<div style="height: 100%; background-color:rgba(0.0,0.0,0.0,0.0);" class="bngApp beamlrui">

<style>
::placeholder {
	color: white;
	font-size:16px;
}

.toggleon{
	border-color:#FF6600;
	border-width:3px;
	border-style:solid;
}

.toggleoff{

}

.tree > div div {
	padding:0px;
}


</style>


<script type="text/ng-template" id="part-tree-partial">

<div class="tree" style="width:100%;">

<!-- Slot tree item container -->
<div ng-repeat="item in items" style="width:100%; text-align:center;">

<div ng-style="(expanded[item.id] && item.children.length > 0) && {'border-top':'solid 1px white','border-bottom':'solid 1px white', 'margin-bottom':'2px'}">

<!-- Item title & expand buttons -->
<div style="line-height:40px;">
<span style="float:left; width:40px;" ng-click="expandSlotTree(item.id)">{{getSlotExpandButton(item.id)}}</span>
<span ng-click="toggleSlotNameMode()">{{getSlotName(item.id)}}</span>
<span style="width:40px; height:40px; float:right;"><img style="width:40px; margin-top:5px;" ng-click="slotFavoriteToggle(item.id)" ng-attr-src="/ui/modules/apps/beamlrui/{{getSlotFavoriteIcon(item.id)}}" width=30px height=30px></img></span>
</div>

<!-- Slot parts container -->
<div ng-if="expanded[item.id]" ng-init="key = item.id">
<table style="font-size:16px; font-weight:normal; border-collapse: collapse; width: 95%; margin: auto; table-layout: fixed; vertical-align:middle; text-align:center;">

<tr style="width:100px;" ng-if="beamlrData['advinvUsed'][key] != null">
	<td style="width: 100px; height:100px; text-align:left;">
	<img style="display:block;" ng-click="imageClicked(beamlrData['partpreview'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]])" ng-if="beamlrData['partpreview'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]] != null" ng-attr-src="{{beamlrData['partpreview'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]]}}" width=90px height=90px />
	<img style="display:block;" ng-if="beamlrData['partpreview'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]] == null" src="/ui/modules/apps/beamlrui/partimg/none.png" width=90px height=90px />
	</td>
	<td style="width:240px;" ng-if="slotNameMode == 0 && beamlrData['partNames'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]] != null"><strong>{{beamlrData['partNames'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]]}}</strong><br>Odometer {{unitConvertedOdometer(getUsedPartOdometer(beamlrData['advinvUsed'][key])) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}<br>Sell Value ${{getUsedPartSellPrice(beamlrData['advinvUsed'][key]) | number:2}}</td>
	<td style="width:240px;" ng-if="slotNameMode == 1 || beamlrData['partNames'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]] == null">{{beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]}}<br>Odometer {{unitConvertedOdometer(getUsedPartOdometer(beamlrData['advinvUsed'][key])) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}<br>Sell Value ${{getUsedPartSellPrice(beamlrData['advinvUsed'][key]) | number:2}}</td>
	<td style="text-align:right;">
	<button ng-disabled="beamlrData['mainpart']==beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]" style="width:90px;" ng-click="advancedPartSet(key, beamlrData['advinvUsed'][key], '')">Remove</button><br><br>
	<button disabled style="width:90px;">Sell</button>
	</td>
</tr>

<tr ng-repeat="(index,pid) in beamlrData['advinvParts'][key]" style="width:100px;">
	<td style="width: 100px; height:100px; text-align:left;">
	<img style="display:block;" ng-click="imageClicked(beamlrData['partpreview'][beamlrData['advinvData'][pid][0]])" ng-if="beamlrData['partpreview'][beamlrData['advinvData'][pid][0]] != null" ng-attr-src="{{beamlrData['partpreview'][beamlrData['advinvData'][pid][0]]}}" width=90px height=90px />
	<img style="display:block;" ng-if="beamlrData['partpreview'][beamlrData['advinvData'][pid][0]] == null" src="/ui/modules/apps/beamlrui/partimg/none.png" width=90px height=90px />
	</td>
	<td style="width:240px;" ng-if="slotNameMode == 0 && beamlrData['partNames'][beamlrData['advinvData'][pid][0]] != null"><strong>{{beamlrData['partNames'][beamlrData['advinvData'][pid][0]]}}</strong><br>Odometer {{unitConvertedOdometer(beamlrData['advinvData'][pid][1]) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}<br>Sell Value ${{getPartSellPrice(pid) | number:2}}</td>
	<td style="width:240px;" ng-if="slotNameMode == 1 || beamlrData['partNames'][beamlrData['advinvData'][pid][0]] == null">{{beamlrData['advinvData'][pid][0]}}<br>Odometer {{unitConvertedOdometer(beamlrData['advinvData'][pid][1]) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}<br>Sell Value ${{getPartSellPrice(pid) | number:2}}</td>
	<td style="text-align:right;">
	<button style="width:90px;" ng-click="advancedPartSet(key, pid, beamlrData['advinvData'][pid][0])">Use</button><br><br>
	<button ng-if="partSellConfirm[pid] == false || partSellConfirm[pid] == null" ng-click="advancedPartSell(pid)" style="width:90px;">Sell</button>
	<button ng-if="partSellConfirm[pid] == true" ng-click="advancedPartSell(pid)" style="width:90px;">Confirm?</button>
	</td>
</tr>
</table>
</div>

<!-- Recursive tree traversal -->
<div ng-if="item.children.length > 0 && expanded[item.id]" ng-init="items = item.children" ng-include="'part-tree-partial'"></div>

</div>
</div>
</div>

</script>



<!--
<img ng-if="showMenu == false" src="/ui/modules/apps/beamlrui/background.png" width=100% height=8% style="z-index:-1; transform:translate(0px,-2px);"/>
<img ng-if="showMenu == true" src="/ui/modules/apps/beamlrui/background.png" width=100% height=100% style="z-index:-1; transform:translate(0px,-2px);"/>
-->
<div style="z-index:999; position:relative;">

<div style="display:block; height:35px; background-color:rgba(0.0,0.0,0.0,0.6); margin:0; transform:translate(0px,-2px);">
<button ng-click="showMenuClick()" ng-if="showMenu" style="position:absolute; left:3px; top:3px;" >▲</button>
<button ng-click="showMenuClick()" ng-if="showMenu==false" style="position:absolute; left:3px; top:3px;" >▼</button>
<p ng-if="beamlrData['waitmsg'] != true" style="font-size: 25px; font-weight:bold; margin:0 auto; text-align:center; width:80%; ">BeamLR Main Menu</p>
<p ng-if="beamlrData['waitmsg'] == true" style="font-size: 25px; font-weight:bold; margin:0 auto; text-align:center; width:80%; ">Loading. Please Wait.</p>
</div>


<div style="height: 420px; background-color:rgba(0.0,0.0,0.0,0.6); transform:translate(0px,-2px);" ng-if="showMenu" >

<table style="margin-left:auto; margin-right:auto; margin-bottom:0; table-layout:fixed; ">
<tr style="height:65px;">
<td style="width:75px; text-align:center;" ng-repeat="button in menuButtons">
<img ng-click="menuClick(button.id)" ng-attr-src="/ui/modules/apps/beamlrui/{{button.svg}}" width=65px height=65px />
</td>
</tr>
<tr style="height:10px; transform:translate(0px,-5px);">
<td style="margin-top:0px; width:75px; text-align: center; vertical-align:top; line-height:18px;" ng-repeat="button in menuButtons">{{button.name}}</td>
</tr>
</table>

<div ng-if="menuPage==0">
<h3 style="text-align:center; line-height:0px;"> Main Menu </h3>

<div style="margin-left: 5px; margin-right: 5px; overflow:scroll; overflow-y:scroll; max-height:250px; max-width:500px; background-color:rgba(0,0,0,0.5);" >

<h2 style="text-align:center;">
Welcome to BeamLR<br>
</h2>

<h3 style="text-align:center;">
Check the github readme for up to date information on mod features and<br>POI maps for each level.
</h3>

<p style="margin-left:10px; margin-right:10px; text-align:center;">
This is a work in progress mod. Remember to back up the BeamLR folder to safekeep your progress.
</p>

<h3 style="text-align:center;">
Thanks for playing!
</h3>

<h2 style="margin-left:10px; margin-right:10px; text-align:center;">
Special thanks to donors!
</h2>

<p style="margin-left:10px; margin-right:10px; text-align:center; font-size:17px; font-weight:bold;">
Luka Rupnik (fabio)<br>
Dimitriu Dragos-Alexandru (rapturereaperALEX)<br>
Bartosz Falba (enouqh)<br>
Mikołaj Bartosz Kuliński<br>
Gál Ádám (Buksikutya77)<br>
Petr Brůžek (NikdoNicNevi)<br>
Jukka-Pekka Tuppurainen<br>
Lauri Kabur<br>
Liam Wood (liamwood15)<br>
Benjamin Rogers (thisvelologist)<br>
Leon Makepeace<br>
Ethan Rapp<br>
Mattia Morris (Mattia83)<br>
Michael Mckinley<br>
Ecril<br>
Jude Thaddeus Persia<br>
Soolek<br>
Lorenzo Boccaccia (LoSboccacc)<br>
Fernando Serafim Marcello<br>
Andrew Barbot<br>
Joe Franco<br>
Zbignev Ulevic<br>
Nuno Medeiros<br>
Preston Knapp<br>
</p>

<h2 style="text-align:center;">
Any questions, feedback, suggestions or problems?
</h2>

<p style="margin-left:10px; margin-right:10px; text-align:center;">
If you have questions, feedback or suggestions, post them on the BeamNG forum thread.
<br><br>
If you want to report potential bugs, make sure you follow the troubleshooting guide on github before posting them on the BeamNG forum thread.
<br><br>
If you have <span style="font-weight:bold;">confirmed</span> bugs that haven't been fixed with the troubleshooting guide, open an issue (preferably with reproduction steps) on github.
</p>

</div>

</div>

<div ng-if="menuPage==1" style="">
<h3 style="text-align:center; line-height:0px;"> Options </h3>

<div style="margin-left: 5px; margin-right: 5px; overflow:scroll; overflow-y:scroll; max-height:250px; max-width:500px; background-color:rgba(0,0,0,0.5)">

<div ng-click="toggleOptionShow('general')" style="width:95%; font-size:20px; font-weight:bold; text-align:center; margin:auto; margin-top:10px;">
<span ng-if="optshow['general'] == false || optshow['general'] == null" style="float:left;">&nbsp+</span>
<span ng-if="optshow['general'] == true" style="float:left;">&nbsp-</span>
<span>General</span>
<span ng-if="optshow['general'] == false || optshow['general'] == null" style="float:right;">+&nbsp</span>
<span ng-if="optshow['general'] == true" style="float:right;">-&nbsp</span>
</div>

<div ng-if="optshow['general'] == true">
<p style="text-align:center;"> 
Player Name 
<input type="text" ng-model="inputData.name" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
<button ng-click="setNameClick()">Set</button>
</p>

<p style="text-align:center;"> 
Vehicle Name 
<input type="text" ng-model="inputData.vehname" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
<button ng-click="setVehNameClick()">Set</button>
</p>

<p style="text-align:center;"> 
Sleep Duration (Hours)  
<input type="number" max=24.0 min=0.5 step=0.5 size=5 maxlength=5 ng-model="inputData.sleepTime" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
<button ng-click="setSleepDuration(inputData.sleepTime)">Set</button>
</p>


<span style="float:left; transform:translate(40px, 0px)">Target Wager &nbsp </span>
<span>
<md-slider flex style="width:150px; transform: translate(150px, -10px); " min="100" max="10000" step="5" ng-model="inputData.targetWager" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()">
</md-slider>
</span>
<span style="float:right; transform:translate(-100px, -45px); width:50px">${{inputData.targetWager}}</span>
<span style="float:right; transform:translate(0px, -45px)">
<button ng-click="setTargetWager(inputData.targetWager)">Set</button>
</span>

<p style="width: 85%; margin:auto; text-align:center; transform:translate(30px,10px);">
Mirror adjustments are saved to vehicle config
</p>

<p style="width: 100%; text-align:center; transform:translate(0px,0px); margin-bottom:50px;">
<span>Mirrors Adjustments</span>
<button ng-click="adjustMirrors()"> Edit </button>
</p>

<p style="text-align:center; transform:translate(50px,-20px); width:350px;"> 
Race Opponent Random Paint
<button ng-class="inputData.raceRandPaint == 1 ? 'toggleon' : 'toggleoff'" ng-click="setOpponentRandomPaint(1)">On</button>
<button ng-class="inputData.raceRandPaint == 0 ? 'toggleon' : 'toggleoff'" ng-click="setOpponentRandomPaint(0)">Off</button>
</p>

<p style="text-align:center; margin-top:5px; margin-bottom:5px;">Time scale requires scenario restart to take effect</p>

<p style="text-align:center; margin-top:5px; margin-bottom:5px;"> 
Time Scale 
<input type="number" max=100.0 min=1.0 step=0.1 size=5 maxlength=5 ng-model="inputData.timeScale" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
<button ng-click="setTimeScale(inputData.timeScale)">Set</button>
</p>

<p style="text-align:center; margin-top:15px; margin-bottom:15px; margin-left:20px; margin-right:20px;">
Default GPS mode shows GPS UI if vehicle has a GPS installed. Always On ignores part check. Regardless of setting GPS UI will be hidden in certain situations.
</p>


<p style="text-align:center; transform:translate(60px,0px); width:350px;"> 
GPS Mode
<button ng-class="inputData.gpsmode == 0 ? 'toggleon' : 'toggleoff'" ng-click="setGPSMode(0)">Default</button>
<button ng-class="inputData.gpsmode == 1 ? 'toggleon' : 'toggleoff'" ng-click="setGPSMode(1)">Always On</button>
<button ng-class="inputData.gpsmode == 2 ? 'toggleon' : 'toggleoff'" ng-click="setGPSMode(2)">Always Off</button>
</p>

<p style="text-align:center; transform:translate(60px,0px); width:350px;"> 
Dragstrip Cinematic Finish
<button ng-class="inputData.dragslowmo == 1 ? 'toggleon' : 'toggleoff'" ng-click="toggleDragSlowmo(1)">On</button>
<button ng-class="inputData.dragslowmo == 0 ? 'toggleon' : 'toggleoff'" ng-click="toggleDragSlowmo(0)">Off</button>
</p>

<p style="text-align:center; transform:translate(60px,0px); width:350px;"> 
Show Groundmarkers
<button ng-class="inputData.gmtoggle == 1 ? 'toggleon' : 'toggleoff'" ng-click="toggleGroundmarkers(1)">On</button>
<button ng-class="inputData.gmtoggle == 0 ? 'toggleon' : 'toggleoff'" ng-click="toggleGroundmarkers(0)">Off</button>
</p>

<p style="text-align:center; transform:translate(60px,0px); width:350px;"> 
Show Floating Markers
<button ng-class="inputData.fmtoggle == 1 ? 'toggleon' : 'toggleoff'" ng-click="toggleMarkers(1)">On</button>
<button ng-class="inputData.fmtoggle == 0 ? 'toggleon' : 'toggleoff'" ng-click="toggleMarkers(0)">Off</button>
</p>

<p style="text-align:center; margin-top:15px; margin-bottom:15px; margin-left:20px; margin-right:20px;">
<strong>Use health system at your own risk!</strong> G force sensors are prone to glitches and may result in unfair deaths.
</p>

<p style="text-align:center; transform:translate(60px,0px); width:350px;"> 
Toggle Health System
<button ng-class="inputData.allowinjury == 1 ? 'toggleon' : 'toggleoff'" ng-click="toggleHealth(1)">On</button>
<button ng-class="inputData.allowinjury == 0 ? 'toggleon' : 'toggleoff'" ng-click="toggleHealth(0)">Off</button>
</p>


<p style="text-align:center; margin-top:15px; margin-bottom:15px; margin-left:20px; margin-right:20px;">
Light manager optimizes night lights on maps that have them. Only used on maps that have light data defined.
</p>

<p style="text-align:center; transform:translate(60px,0px); width:350px;"> 
Toggle Light Manager
<button ng-class="inputData.lmtoggle == 1 ? 'toggleon' : 'toggleoff'" ng-click="toggleLightManager(1)">On</button>
<button ng-class="inputData.lmtoggle == 0 ? 'toggleon' : 'toggleoff'" ng-click="toggleLightManager(0)">Off</button>
</p>
</div>

<div ng-click="toggleOptionShow('career')" style="width:95%; font-size:20px; font-weight:bold; text-align:center; margin:auto; margin-top:10px;">
<span ng-if="optshow['career'] == false || optshow['career'] == null" style="float:left;">&nbsp+</span>
<span ng-if="optshow['career'] == true" style="float:left;">&nbsp-</span>
<span>Career</span>
<span ng-if="optshow['career'] == false || optshow['career'] == null" style="float:right;">+&nbsp</span>
<span ng-if="optshow['career'] == true" style="float:right;">-&nbsp</span>
</div>

<div ng-if="optshow['career'] == true">
<p style="text-align:center;"> 
Current Career Seed: {{beamlrData['seed']}}
</p>

<p style="text-align:center;">  Next seed takes effect after career reset </p>

<p style="text-align:center;"> 
Next Seed
<input type="text" maxlength=10 size=11 ng-model="inputData.seed" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
<button ng-click="setSeed()">Set</button>
<button ng-click="setRandomSeed()">Random</button>
</p>

<p style="text-align:center; margin-top:15px; margin-bottom:15px; margin-left:20px; margin-right:20px;">
Auto Increment Seed adds 1 to current seed for next seed used after career reset.
</p>

<p style="text-align:center;"> 
Auto Increment Seed 
<button ng-class="inputData.autoseed == 1 ? 'toggleon' : 'toggleoff'" ng-click="setAutoSeed(1)">On</button>
<button ng-class="inputData.autoseed == 0 ? 'toggleon' : 'toggleoff'" ng-click="setAutoSeed(0)">Off</button>
</p>

<br>

<p style="text-align:center;">Difficulty affects amount of starting money and garage slots. Takes effect after career reset.</p>

<p style="text-align:center;"> 
Difficulty Level
<button ng-class="inputData.difficulty == 'easy' ? 'toggleon' : 'toggleoff'" ng-click="setDifficulty('easy')">Easy</button>
<button ng-class="inputData.difficulty == 'medium' ? 'toggleon' : 'toggleoff'" ng-click="setDifficulty('medium')">Medium</button>
<button ng-class="inputData.difficulty == 'hard' ? 'toggleon' : 'toggleoff'" ng-click="setDifficulty('hard')">Hard</button>
</p>

<br>

<p style="text-align:center;">Using a custom wager and rep scale will affect<br>career difficulty and progress rate</p>

<p style="text-align:center;"> 
Race wager scale
<input type="number" max=5.0 min=0.5 step=0.1 size=5 maxlength=4 ng-model="inputData.wagerscl" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
<button ng-click="setWagerScale(inputData.wagerscl)">Set</button>
</p>

<p style="text-align:center;"> 
Race reputation scale
<input type="number" max=5.0 min=0.5 step=0.1 size=5 maxlength=4 ng-model="inputData.repscl" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
<button ng-click="setRepScale(inputData.repscl)">Set</button>
</p>

<p style="text-align:center; margin-top:15px; margin-bottom:15px; margin-left:20px; margin-right:20px;">
Restricted race leagues don't allow vehicles above a certain performance class. You will be allowed to skip leagues if your car is too powerful (up to gold league).
</p>

<p style="text-align:center;"> 
Restricted race leagues
<button ng-class="inputData.lrestrict == 1 ? 'toggleon' : 'toggleoff'" ng-click="setLeagueRestriction(1)">On</button>
<button ng-class="inputData.lrestrict == 0 ? 'toggleon' : 'toggleoff'" ng-click="setLeagueRestriction(0)">Off</button>
</p>

<p style="text-align:center; margin-top:15px; margin-bottom:15px; margin-left:20px; margin-right:20px;">
Randomly seeded race clubs allows re-rolling races. <strong>Off</strong> is the intended way to play. When turned off races can only be re-rolled by sleeping to next day.
</p>

<p style="text-align:center;"> 
Randomly seeded race clubs
<button ng-class="inputData.rsraces == 1 ? 'toggleon' : 'toggleoff'" ng-click="setRandomRaceSeedMode(1)">On</button>
<button ng-class="inputData.rsraces == 0 ? 'toggleon' : 'toggleoff'" ng-click="setRandomRaceSeedMode(0)">Off</button>
</p>

<p style="text-align:center; margin-top:15px; margin-bottom:15px; margin-left:20px; margin-right:20px;">
Limited garage slots requires you to buy properties to increase space in your garage. <strong>On</strong> is the intended way to play.
</p>

<p style="text-align:center;"> 
Limited garage slots
<button ng-class="inputData.lgslots == 1 ? 'toggleon' : 'toggleoff'" ng-click="limitedGarageToggle(1)">On</button>
<button ng-class="inputData.lgslots == 0 ? 'toggleon' : 'toggleoff'" ng-click="limitedGarageToggle(0)">Off</button>
</p>

<p style="text-align:center; margin-top:15px; margin-bottom:15px; margin-left:20px; margin-right:20px;">
Track event slicks mode makes all track event opponent tires behave like slicks to improve their handling. <strong>On</strong> is the intended way to play.
</p>

<p style="text-align:center;"> 
Track event slicks mode
<button ng-class="inputData.allowtesmode == 1 ? 'toggleon' : 'toggleoff'" ng-click="trackEventSlicksToggle(1)">On</button>
<button ng-class="inputData.allowtesmode == 0 ? 'toggleon' : 'toggleoff'" ng-click="trackEventSlicksToggle(0)">Off</button>
</p>

<br>

<p style="text-align:center;">
Career backup is automatically saved in <br><span style="font-weight:bold;">userfolder/beamLR/backup</span><br> when you stop the mission
</p>
<p style="text-align:center;">
Load Career Backup
<button ng-click="restoreBackup()">Load</button>
</p>

<br>

<p style="text-align:center;">
Please be patient during career reset. The scenario will be stopped and started again automatically.
</p>

<p style="text-align:center; color:yellow;"> 
Reset Career (WARNING: PERMANENT)
<button ng-if="resetConfirm == false" ng-click="resetCareer()">Reset Career</button>
<button ng-if="resetConfirm == true" ng-click="resetCareer()">Confirm Reset?</button>
</p>

<br>

</div>

<div ng-click="toggleOptionShow('ui')" style="width:95%; font-size:20px; font-weight:bold; text-align:center; margin:auto; margin-top:10px;">
<span ng-if="optshow['ui'] == false || optshow['ui'] == null" style="float:left;">&nbsp+</span>
<span ng-if="optshow['ui'] == true" style="float:left;">&nbsp-</span>
<span>User Interface</span>
<span ng-if="optshow['ui'] == false || optshow['ui'] == null" style="float:right;">+&nbsp</span>
<span ng-if="optshow['ui'] == true" style="float:right;">-&nbsp</span>
</div>

<div ng-if="optshow['ui'] == true">
<p style="text-align:center; margin-top:15px; margin-bottom:15px; margin-left:20px; margin-right:20px;">
IMGUI scale parameter can be used to increase interactive menu sizes when playing at high resolution.
UI app scaling can be changed from the BeamNG options menu.
</p>

<p style="text-align:center; margin-top:5px; margin-bottom:5px;"> 
IMGUI Scale
<input type="number" max=10.0 min=0.01 step=0.01 size=5 maxlength=5 ng-model="inputData.imguiScale" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
<button ng-click="setIMGUIScale(inputData.imguiScale)">Set</button>
</p>

<p style="text-align:center; margin-top:15px; margin-bottom:15px; margin-left:20px; margin-right:20px;">
IMGUI layout will store menu positions, sizes and docking states. Remember to save the layout immediately after making changes.
This feature is especially useful when using a custom IMGUI scale.
</p>

<p style="text-align:center; margin-top:5px; margin-bottom:5px;"> 
IMGUI Layout
<button ng-click="saveIMGUI()">Save</button>
<button ng-click="loadIMGUI()">Load</button>
</p>

<p style="text-align:center; margin-top:15px; margin-bottom:15px; margin-left:20px; margin-right:20px;">
IMGUI Layout Autosave will save your menu layout when quitting.
</p>

<p style="text-align:center; margin-top:5px; margin-bottom:5px;"> 
IMGUI Layout Autosave
<button ng-class="inputData.imautosave == 1 ? 'toggleon' : 'toggleoff'" ng-click="autosaveIMGUI(1)">On</button>
<button ng-class="inputData.imautosave == 0 ? 'toggleon' : 'toggleoff'" ng-click="autosaveIMGUI(0)">Off</button>
</p>


<p style="text-align:center; margin-top:15px; margin-bottom:10px; margin-left:20px; margin-right:20px;">
Part Preview Scaling Mode
</p>

<p style="text-align:center; margin-top:5px; margin-bottom:5px;"> 
<button ng-class="inputData.imgmode == 0 ? 'toggleon' : 'toggleoff'" ng-click="setImageUIMode(0)">Original Size</button>
<button ng-class="inputData.imgmode == 1 ? 'toggleon' : 'toggleoff'" ng-click="setImageUIMode(1)">Scale To Fit</button>
</p>

<p style="text-align:center; margin-top:15px; margin-bottom:15px; margin-left:20px; margin-right:20px;">
Part Edit List Mode changes the list view in part edit. Sorted View is the original BeamLR view. Tree View has slots nested inside their parent slot, similar to vanilla BeamNG.
</p>
<p style="text-align:center; margin-top:15px; margin-bottom:10px; margin-left:20px; margin-right:20px;">
Part Edit List Mode
</p>
<p style="text-align:center; margin-top:5px; margin-bottom:5px;"> 
<button ng-class="inputData.edittreemode == 0 ? 'toggleon' : 'toggleoff'" ng-click="setEditTreeMode(0)">Sorted View</button>
<button ng-class="inputData.edittreemode == 1 ? 'toggleon' : 'toggleoff'" ng-click="setEditTreeMode(1)">Tree View</button>
</p>

<p style="text-align:center; margin-top:15px; margin-bottom:15px; margin-left:20px; margin-right:20px;">
Part Shop Show Incompatible turned on will show currently incompatible slots in yellow with a warning label. Off will ignore such slots.
</p>
<p style="text-align:center; margin-top:15px; margin-bottom:10px; margin-left:20px; margin-right:20px;">
Part Shop Show Incompatible
</p>
<p style="text-align:center; margin-top:5px; margin-bottom:5px;"> 
<button ng-class="inputData.pshopshowinc == 1 ? 'toggleon' : 'toggleoff'" ng-click="togglePartShopShowIncompatible(1)">On</button>
<button ng-class="inputData.pshopshowinc == 0 ? 'toggleon' : 'toggleoff'" ng-click="togglePartShopShowIncompatible(0)">Off</button>
</p>



</div>

<div ng-click="toggleOptionShow('traffic')" style="width:95%; font-size:20px; font-weight:bold; text-align:center; margin:auto; margin-top:10px;">
<span ng-if="optshow['traffic'] == false || optshow['traffic'] == null" style="float:left;">&nbsp+</span>
<span ng-if="optshow['traffic'] == true" style="float:left;">&nbsp-</span>
<span>Traffic</span>
<span ng-if="optshow['traffic'] == false || optshow['traffic'] == null" style="float:right;">+&nbsp</span>
<span ng-if="optshow['traffic'] == true" style="float:right;">-&nbsp</span>
</div>

<div ng-if="optshow['traffic'] == true">

<p style="text-align:center;">Changing traffic amounts & parameters requires scenario restart to take effect</p>

<p style="text-align:center;"> 
Civilian Count
<input type="number" style="text-align:center;" ng-model="inputData.traffic" min=0 max=20 ng-change="setTrafficDensity()"></input>
<button ng-click="setDefaultValue('traffic')">Reset</button>
</p>

<p style="text-align:center;"> 
Police Count
<input type="number" style="text-align:center;"  ng-model="inputData.police" min=0 max=5 ng-change="setPoliceDensity()"></input>
<button ng-click="setDefaultValue('police')">Reset</button>
</p>


<p style="text-align:center;"> 
Truck Count
<input type="number" style="text-align:center;"  ng-model="inputData.trucks" min=0 max=5 ng-change="setTruckDensity()"></input>
<button ng-click="setDefaultValue('trucks')">Reset</button>
</p>

<p style="text-align:center; width:450px; margin-left:auto; margin-right:auto;" >Max Active Traffic is the max amount of active vehicles on the map. The rest is used to increase traffic diversity.</p>

<p style="text-align:center;"> 
Max Active Traffic
<input type="number" style="text-align:center;"  ng-model="inputData.atcount" min=0 max="{{(inputData.traffic + inputData.police + inputData.trucks) || 0}}" ng-change="setActiveTrafficCount()"></input>
<button ng-click="setDefaultValue('atcount')">Reset</button>
</p>

<p style="text-align:center; width:450px; margin-left:auto; margin-right:auto;" >Respawn Rate affects how fast the game teleports traffic to a new location. High values will increase perceived traffic but will cause visible traffic pop in. Lower values will prioritize spawning traffic hidden from camera.</p>

<p style="text-align:center;"> 
Respawn Rate
<input type="number" style="text-align:center;"  ng-model="inputData.tsrate" min=0.01 max=1 step=0.01 ng-change="setTrafficSpawnRate()"></input>
<button ng-click="setDefaultValue('tsrate')">Reset</button>
</p>

<p style="text-align:center; width:450px; margin-left:auto; margin-right:auto;" >Direction Bias affects traffic direction when spawning. Values closer to 1 means more oncoming traffic, closer -1 means more traffic on your side of the road. Note that this parameter is often ignored by the game.</p>

<p style="text-align:center;"> 
Direction Bias
<input type="number" style="text-align:center;"  ng-model="inputData.tsbias" min=-1 max=1 step=0.01 ng-change="setTrafficDirectionBias()"></input>
<button ng-click="setDefaultValue('tsbias')">Reset</button>
</p>



<p style="text-align:center;"> 
Traffic Risk 
<input type="number" ng-change="setTrafficRisk()" min=0.01 max=1 step=0.01 maxlength=10 size=5 ng-model="inputData.trisk" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
<button ng-click="setDefaultValue('trisk')">Reset</button>
</p>

<p style="text-align:center;"> 
Police Strictness
<input type="number" ng-change="setPoliceStrictness()" min=0 max=1 step=0.01 size=5 ng-model="inputData.copstrict" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
<button ng-click="setDefaultValue('copstrict')">Reset</button>
</p>

<p style="text-align:center;"> 
Load default traffic values
<button ng-click="setAllDefaultValues()">Load Defaults</button>
</p>

<p style="text-align:center; width:450px; margin-left:auto; margin-right:auto;" >Race traffic default mode uses race file parameter. Using traffic for all races may negatively impact opponent skill.</p>

<p style="text-align:center; transform:translate(40px,0px); width:400px;"> 
Race Traffic
<button ng-class="inputData.rtmode == 0 ? 'toggleon' : 'toggleoff'" ng-click="setRaceTraffic(0)">Default</button>
<button ng-class="inputData.rtmode == 2 ? 'toggleon' : 'toggleoff'" ng-click="setRaceTraffic(2)">Always On</button>
<button ng-class="inputData.rtmode == 1 ? 'toggleon' : 'toggleoff'" ng-click="setRaceTraffic(1)">Always Off</button>
</p>

<p style="text-align:center; width:450px; margin-left:auto; margin-right:auto;" >Instant toggle traffic removes lag when spawning traffic after races & challenges. Prevents the game from freeing up RAM when traffic is disabled. Also reduces traffic diversity due to same vehicles always being used.</p>

<p style="text-align:center; transform:translate(40px,0px); width:400px;"> 
Instant Toggle Traffic 
<button ng-class="inputData.tfasttoggle == 1 ? 'toggleon' : 'toggleoff'" ng-click="setTrafficFastToggle(1)">On</button>
<button ng-class="inputData.tfasttoggle == 0 ? 'toggleon' : 'toggleoff'" ng-click="setTrafficFastToggle(0)">Off</button>
</p>

<p style="text-align:center; width:450px; margin-left:auto; margin-right:auto;" >Use this setting to manually toggle traffic for debug or testing purposes. Can be used to spawn new variants if Instant Toggle Traffic is off.</p>

<p style="text-align:center; transform:translate(40px,0px); width:400px;"> 
Manual Traffic Toggle
<button class="toggleoff" ng-click="trafficToggle(1)">On</button>
<button class="toggleoff" ng-click="trafficToggle(0)">Off</button>
</p>
</div>

<div ng-click="toggleOptionShow('weather')" style="width:95%; font-size:20px; font-weight:bold; text-align:center; margin:auto; margin-top:10px;">
<span ng-if="optshow['weather'] == false || optshow['weather'] == null" style="float:left;">&nbsp+</span>
<span ng-if="optshow['weather'] == true" style="float:left;">&nbsp-</span>
<span>Dynamic Weather</span>
<span ng-if="optshow['weather'] == false || optshow['weather'] == null" style="float:right;">+&nbsp</span>
<span ng-if="optshow['weather'] == true" style="float:right;">-&nbsp</span>
</div>

<div ng-if="optshow['weather'] == true">
<p style="text-align:center; width:450px; margin-left:auto; margin-right:auto;" >Dynamic weather will smoothly change weather condition throughout the day. Weather changes from day to day using career seed. Time scale affects weather change rate.</p>

<p style="text-align:center; margin-top:5px; margin-bottom:5px;"> 
Dynamic Weather Toggle
<button ng-class="inputData.dwtoggle == 1 ? 'toggleon' : 'toggleoff'" ng-click="dwtoggle(1)">On</button>
<button ng-class="inputData.dwtoggle == 0 ? 'toggleon' : 'toggleoff'" ng-click="dwtoggle(0)">Off</button>
</p>

<p style="text-align:center; width:450px; margin-left:auto; margin-right:auto;" >Variability values control chance of bad weather. Lower values will make clear sky, low wind and low fog more likely. Set value to 0 to disable dynamic weather for a specific weather element (will use values set in freeroam).</p>


<p style="text-align:center;"> 
Cloud Cover Variability
<input type="number" min=0 max=1 step=0.01 maxlength=10 size=5 ng-model="inputData.ccvar" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
<button ng-click="setCloudCoverVar(inputData.ccvar)">Set</button>
</p>

<p style="text-align:center;"> 
Wind Speed Variability
<input type="number" min=0 max=1 step=0.01 maxlength=10 size=5 ng-model="inputData.wsvar" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
<button ng-click="setWindSpeedVar(inputData.wsvar)">Set</button>
</p>

<p style="text-align:center;"> 
Fog Density Variability
<input type="number" min=0 max=1 step=0.01 maxlength=10 size=5 ng-model="inputData.fdvar" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
<button ng-click="setFogDensityVar(inputData.fdvar)">Set</button>
</p>

</div>

<div ng-click="toggleOptionShow('advanced')" style="width:95%; font-size:20px; font-weight:bold; text-align:center; margin:auto; margin-top:10px;">
<span ng-if="optshow['advanced'] == false || optshow['advanced'] == null" style="float:left;">&nbsp+</span>
<span ng-if="optshow['advanced'] == true" style="float:left;">&nbsp-</span>
<span>Advanced</span>
<span ng-if="optshow['advanced'] == false || optshow['advanced'] == null" style="float:right;">+&nbsp</span>
<span ng-if="optshow['advanced'] == true" style="float:right;">-&nbsp</span>
</div>

<div ng-if="optshow['advanced'] == true">
<p style="text-align:center;">  Use the "Fix Cops" button only if police chases player without pursuit UI showing. Do not use when pursuit UI is showing to avoid further bugs with police system.</p>

<p style="text-align:center;"> 
Manual Police Role Fix
<button ng-click="forcedCopfix()">Fix Cops</button>
</p>

<p style="text-align:center;">  Automatic fixing may impact performance with large amounts of police vehicles.</p>


<p style="text-align:center;"> 
Automatic Police Role Fix
<button ng-class="inputData.autoCopfix == 1 ? 'toggleon' : 'toggleoff'" ng-click="autoCopfix(1)">On</button>
<button ng-class="inputData.autoCopfix == 0 ? 'toggleon' : 'toggleoff'" ng-click="autoCopfix(0)">Off</button>
</p>


<p style="text-align:center;">  Use beamstate toggle to workaround issues with advanced couplers.</p>


<p style="text-align:center;"> 
Beamstate Toggle 
<button ng-class="inputData.bstoggle == 1 ? 'toggleon' : 'toggleoff'" ng-click="beamstateToggle(1)">On</button>
<button ng-class="inputData.bstoggle == 0 ? 'toggleon' : 'toggleoff'" ng-click="beamstateToggle(0)">Off</button>
</p>


<p style="text-align:center;">  Use below button to attempt coupler reset after beamstate loading breaks them (game may crash).</p>

<p style="text-align:center;"> 
Reset Advanced Couplers
<button ng-click="resetCouplers()">Reset</button>
</p>

<!-- ADVANCED REPAIR IS FORCED ENABLED AS OF 1.17.5 DUE TO OLD REPAIR CAUSING ISSUES
<p style="text-align:center;">  
Advanced repair cost uses improved code for more accurate repair cost calculation, relying on broken/deformed beams<br>and part specific costs. Will likely result in higher repair costs especially for high end vehicles.
</p>

<p style="text-align:center;"> 
Advanced Repair Cost
<button ng-class="inputData.advrepaircost == 1 ? 'toggleon' : 'toggleoff'" ng-click="arcToggle(1)">On</button>
<button ng-class="inputData.advrepaircost == 0 ? 'toggleon' : 'toggleoff'" ng-click="arcToggle(0)">Off</button>
</p>

<p ng-if="inputData.advrepaircost == 1" style="text-align:center;">  
Advanced repair UI allows for part specific repairs.<br>Damaged parts will be removed unless repaired.<br>Removed damaged parts are not added to inventory.<br><br>This setting requires Advanced Repair Cost to be enabled.
</p>

<p ng-if="inputData.advrepaircost == 1" style="text-align:center;"> 
Advanced Repair UI
<button ng-class="inputData.useadvrepairui == 1 ? 'toggleon' : 'toggleoff'" ng-click="aruiToggle(1)">On</button>
<button ng-class="inputData.useadvrepairui == 0 ? 'toggleon' : 'toggleoff'" ng-click="aruiToggle(0)">Off</button>
</p>
-->

<p style="text-align:center;">  
Part edit safe mode helps to prevent taking damage during part edits by temporarily increasing beam strength. Useful when removing wheels but can be kept off for most edits.
</p>

<p style="text-align:center;"> 
Part Edit Safe Mode
<button ng-class="inputData.gsafemode == 1 ? 'toggleon' : 'toggleoff'" ng-click="safeModeToggle(1)">On</button>
<button ng-class="inputData.gsafemode == 0 ? 'toggleon' : 'toggleoff'" ng-click="safeModeToggle(0)">Off</button>
</p>

<p style="text-align:center; width:95%; margin-left:auto; margin-right:auto;">  
Damage Bypass Mode allows part edits even if your vehicle is damaged. This is a cheat as it allows free repairs. Use as a last resort if part edit safe mode doesn't work.
</p>

<p style="text-align:center;"> 
Damage Bypass Mode
<button ng-class="inputData.dbypass == 1 ? 'toggleon' : 'toggleoff'" ng-click="damageBypassToggle(1)">On</button>
<button ng-class="inputData.dbypass == 0 ? 'toggleon' : 'toggleoff'" ng-click="damageBypassToggle(0)">Off</button>
</p>

<p style="text-align:center; width:95%; margin-left:auto; margin-right:auto;">  
Manual Cache Update will force update the jbeam file caches. Use this to update jbeam cache when you add jbeam files that aren't stored in a mod zip.
</p>

<p style="text-align:center;"> 
Manual Cache Update
<button ng-click="startManualCache()">Execute</button>
</p>

</div>

<br>



</div>


</div>

<!-- PART BUYING START -->

<div ng-if="menuPage==2" style="">
<h3 style="text-align:center; line-height:0px;"> Buy Parts ({{beamlrData['shopPriceScale'] * 100.0 | number:0}}% Cost)</h3>

<div ng-if="(beamlrData['triggerState'] == 1 || beamlrData['triggerState'] == 2) && beamlrData['playerWalking'] == 0">

<div style="text-align:center; transform:translate(0, -5px);" >
	<button ng-click="filter(0,'all')">All</button> 
	<button ng-click="filter(0,'body')">Body</button> 
	<button ng-click="filter(0,'engine')">Engine</button> 
	<button ng-click="filter(0,'suspension')">Suspension</button> 
	<button ng-click="filter(0,'favorites')">Favs</button> 
	<input style="width:75px" type="text" ng-model="inputData.searchFilter" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
	<button ng-click="search(0)">&#x1F50D</button>
</div>

<div style="margin-left: 5px; margin-right: 5px; overflow-y:scroll; max-height:220px; min-height:220px; max-width:500px; background-color:rgba(0,0,0,0.5);" >

<div ng-repeat="(id,key) in beamlrData['sortedShopSlots'] track by id">
<div ng-if="beamlrData['availParts'][key] != null && key != 'main' && (inputData.pshopshowinc == 1 || beamlrData['vehSlotIDs'][key] != null)">

<div style="word-wrap:break-word; text-align:center; font-weight: bold; font-size:20px; width:100%; line-height:40px;" ng-if="getSlotName(key) != null && slotNameMode != 1">
	<span ng-if="visibleSlots[key] == null || visibleSlots[key] == false" style="float:left; text-align:center; width:40px;" ng-click="slotToggle(key, true)">+</span>
	<span ng-if="visibleSlots[key] == true" style="float:left; text-align:center; width:40px;" ng-click="slotToggle(key, false)">-</span>
	<span ng-if="beamlrData['vehSlotIDs'][key] != null" style="text-align:center; display:inline-block; max-width:80%;" ng-click="setSlotNameMode(1)"> {{getSlotName(key)}} </span>
	<span ng-if="beamlrData['vehSlotIDs'][key] == null" style="text-align:center; display:inline-block; max-width:80%; color:yellow;" ng-click="setSlotNameMode(1)"> {{getSlotName(key)}} &nbsp &#9888;</span>
	<span style="width:40px; height:40px; float:right;"><img style="width:40px; margin-top:5px;" ng-click="slotFavoriteToggle(key)" ng-attr-src="/ui/modules/apps/beamlrui/{{getSlotFavoriteIcon(key)}}" width=30px height=30px></img></span>
</div>

<div style="word-wrap:break-word; text-align:center; font-weight: bold; font-size:20px; width:100%; line-height:40px;" ng-if="getSlotName(key) == null || slotNameMode == 1">
	<span ng-if="visibleSlots[key] == null || visibleSlots[key] == false" style="float:left; text-align:center; width:40px;" ng-click="slotToggle(key, true)">+</span>
	<span ng-if="visibleSlots[key] == true" style="float:left; text-align:center; width:40px;" ng-click="slotToggle(key, false)">-</span>
	<span ng-if="beamlrData['vehSlotIDs'][key] != null" style="text-align:center; display:inline-block; max-width:80%;" ng-click="setSlotNameMode(0)"> {{key}} </span>
	<span ng-if="beamlrData['vehSlotIDs'][key] == null" style="text-align:center; display:inline-block; max-width:80%; color:yellow;" ng-click="setSlotNameMode(0)"> {{key}} &nbsp &#9888;</span>
	<span style="width:40px; height:40px; float:right;"><img style="width:40px; margin-top:5px;" ng-click="slotFavoriteToggle(key)" ng-attr-src="/ui/modules/apps/beamlrui/{{getSlotFavoriteIcon(key)}}" width=30px height=30px></img></span>
</div>

<div ng-if="visibleSlots[key] == true" style="margin-left:5px; line-height:150px;" ng-repeat="(pid,part) in beamlrData['sortedShopParts'][key] track by pid"> 
<div ng-if="beamlrData['availParts'][key][part] != null">

<span style="float:left; height:90px; transform:translate(0px, 30px);">
	<img ng-click="imageClicked(beamlrData['partpreview'][part])" ng-if="beamlrData['partpreview'][part] != null" ng-attr-src="{{beamlrData['partpreview'][part]}}" width=90px height=90px />
	<img ng-if="beamlrData['partpreview'][part] == null" src="/ui/modules/apps/beamlrui/partimg/none.png" width=90px height=90px />
</span>

<div ng-if="slotNameMode!=1">
<span ng-if="beamlrData['vehInstParts'][part] == null && (beamlrData['advinvOwned'][part] == null || beamlrData['advinvOwned'][part] == 0)" style="transform:translate(20px, 0px); display:inline-block; text-align:center; line-height:20px; width: 200px; margin-left:20px; vertical-align:middle; overflow-wrap:break-word;">{{beamlrData['partNames'][part]}}</span>
<span ng-if="beamlrData['vehInstParts'][part] == null && beamlrData['advinvOwned'][part] > 0" style="transform:translate(20px, 0px); display:inline-block; text-align:center; line-height:20px; width: 200px; margin-left:20px; vertical-align:middle; overflow-wrap:break-word;">{{beamlrData['partNames'][part]}}<br>(OWN {{beamlrData['advinvOwned'][part]}})</span>
<span ng-if="beamlrData['vehInstParts'][part] != null" style="transform:translate(20px, 0px); display:inline-block; text-align:center; line-height:20px; width: 200px; margin-left:20px; vertical-align:middle; overflow-wrap:break-word;">{{beamlrData['partNames'][part]}}<br>(INSTALLED)</span>
<span style="float:right; margin-right:5px; vertical-align:middle;">


<table style="height:100px; line-height:20px;">
	<tr style="height:25%; width:100px;">
		<td>
		<p style="text-align:center; margin:0;" ng-if="beamlrData['partPrices'][part] == null">${{beamlrData['partPrices']['default'] * beamlrData['shopPriceScale'] | number:2}}</p>
		<p style="text-align:center; margin:0;" ng-if="beamlrData['partPrices'][part] != null">${{beamlrData['partPrices'][part] * beamlrData['shopPriceScale'] | number:2}}</p>
		</td>
	</tr>
	<tr style="height:25%;">
		<td>
		<button style="width:100px;" ng-click="shopPartClick(part)">Buy New</button>
		</td>
	</tr>
	<tr style="height:25%;">
		<td>
		<p style="text-align:center; margin:0;" ng-if="beamlrData['partPrices'][part] == null">${{beamlrData['partPrices']['default'] * beamlrData['shopPriceScale'] * getShopUsedPartPriceScale(part) | number:2}}<br>({{getShopUsedPartOdometer(part, true) / 1000000.0 | number:1}}K {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}})</p>
		<p style="text-align:center; margin:0;" ng-if="beamlrData['partPrices'][part] != null">${{beamlrData['partPrices'][part] * beamlrData['shopPriceScale'] * getShopUsedPartPriceScale(part)| number:2}}<br>({{getShopUsedPartOdometer(part, true) / 1000000.0 | number:1}}K {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}})</p>
		</td>
	</tr>
	<tr style="height:25%;">
		<td>
		<button ng-disabled="usedPartDayDataCheck(part)" style="width:100px;" ng-click="shopUsedPartBuy(part)">Buy Used</button>
		</td>
	</tr>
</table>

</span>
</div>

<div ng-if="slotNameMode==1">
<span ng-if="beamlrData['vehInstParts'][part] == null && (beamlrData['advinvOwned'][part] == null || beamlrData['advinvOwned'][part] == 0)" style="transform:translate(20px, 0px); display:inline-block; text-align:center; line-height:20px; width: 200px; margin-left:20px; vertical-align:middle; overflow-wrap:break-word;">{{part}}</span>
<span ng-if="beamlrData['vehInstParts'][part] == null && beamlrData['advinvOwned'][part] > 0" style="transform:translate(20px, 0px); display:inline-block; text-align:center; line-height:20px; width: 200px; margin-left:20px; vertical-align:middle; overflow-wrap:break-word;">{{part}} (OWN {{beamlrData['advinvOwned'][part]}})</span>
<span ng-if="beamlrData['vehInstParts'][part] != null" style="transform:translate(20px, 0px); display:inline-block; text-align:center; line-height:20px; width: 200px; margin-left:20px; vertical-align:middle; overflow-wrap:break-word;">{{part}} (INSTALLED)</span>
<span style="float:right; margin-right:5px; vertical-align:middle;">

<table style="height:100px; line-height:20px;">
	<tr style="height:25%; width:100px;">
		<td>
		<p style="text-align:center; margin:0;" ng-if="beamlrData['partPrices'][part] == null">${{beamlrData['partPrices']['default'] * beamlrData['shopPriceScale'] | number:2}}</p>
		<p style="text-align:center; margin:0;" ng-if="beamlrData['partPrices'][part] != null">${{beamlrData['partPrices'][part] * beamlrData['shopPriceScale'] | number:2}}</p>
		</td>
	</tr>
	<tr style="height:25%;">
		<td>
		<button style="width:100px;" ng-click="shopPartClick(part)">Buy New</button>
		</td>
	</tr>
	<tr style="height:25%;">
		<td>
		<p style="text-align:center; margin:0;" ng-if="beamlrData['partPrices'][part] == null">${{beamlrData['partPrices']['default'] * beamlrData['shopPriceScale'] * getShopUsedPartPriceScale(part) | number:2}}<br>({{getShopUsedPartOdometer(part,true) / 1000000.0 | number:1}}K {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}})</p>
		<p style="text-align:center; margin:0;" ng-if="beamlrData['partPrices'][part] != null">${{beamlrData['partPrices'][part] * beamlrData['shopPriceScale'] * getShopUsedPartPriceScale(part)| number:2}}<br>({{getShopUsedPartOdometer(part,true) / 1000000.0 | number:1}}K {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}})</p>
		</td>
	</tr>
	<tr style="height:25%;">
		<td>
		<button ng-disabled="usedPartDayDataCheck(part)" style="width:100px;" ng-click="shopUsedPartBuy(part)">Buy Used</button>
		</td>
	</tr>
</table>

</span>
</div>

</div>

</div>

</div>
</div>

</div>


</div> 

<div ng-if="beamlrData['playerWalking'] == 0">
<div ng-if="beamlrData['triggerState'] != 1 && beamlrData['triggerState'] != 2">
<h2 style="text-align:center;" > Get to a Shop or Garage! </h2>
</div>
</div>

<div ng-if="beamlrData['playerWalking'] != 0">
<h2 style="text-align:center;" > Cannot use while walking. </h2>
</div>


</div>

<!-- PART BUYING END -->

<div ng-if="menuPage==3" style="">
<h3 ng-if="editMode == 0" style="text-align:center; line-height:0px;"> Edit Car Parts </h3>
<h3 ng-if="editMode == 1" style="text-align:center; line-height:0px;"> Save/Load Config </h3>
<h3 ng-if="editMode == 2" style="text-align:center; line-height:0px;"> Edit Car Paint </h3>
<div ng-if="beamlrData['triggerState'] == 2 && beamlrData['playerDamage'] <= 1.0 && beamlrData['playerWalking'] == 0 && beamlrData['vehicleRestricted'] != true" >

<div style="text-align:center; transform:translate(0, -5px);" >


	
<button ng-if="editMode == 0" ng-click="setEditMode(1)" style="width:40px; border-radius:10px; ">&#128190;</button>
<button ng-if="editMode == 1" ng-click="setEditMode(2)" style="width:40px; border-radius:10px; ">&#127912;</button> 
<button ng-if="editMode == 2" ng-click="setEditMode(0)" style="width:40px; border-radius:10px; ">&#128736;</button> 
<button ng-click="filter(1,'all')"><span ng-if="inputData.edittreemode == 1">Tree</span><span ng-if="inputData.edittreemode == 0">All</span></button> 
<button ng-click="filter(1,'body')">Body</button> 
<button ng-click="filter(1,'engine')">Engine</button> 
<button ng-click="filter(1,'suspension')">Susp</button>
<button ng-click="filter(1,'favorites')">Favs</button> 
<input style="width:75px" type="text" ng-model="inputData.searchFilter" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" />
<button style="border-radius:10px;" ng-click="search(1)">&#x1F50D</button>
</div>

<div ng-if="editMode == 0" style="margin-left: 5px; margin-right: 5px; overflow-y:scroll; max-height:220px; min-height:220px; max-width:500px; background-color:rgba(0,0,0,0.5);">

<!-- PART EDIT TREE VIEW MODE START -->

<!-- Main slot tree container -->
<div ng-if="inputData.edittreemode == 1 && !searching" class="tree" style="width:100%; margin:auto; font-size:20px; font-weight:bold;">

<!-- Slot tree item container -->
<div ng-repeat="item in beamlrData['slotTree'].children[0].children"  style="width:100%; text-align:center;">

<!-- Draws border around expanded slots that have children -->
<div ng-style="(expanded[item.id] && item.children.length > 0) && {'border-top':'solid 1px white','border-bottom':'solid 1px white','margin-bottom':'2px'}">

<!-- Item title & expand buttons -->
<div style="line-height:40px;">
<span style="float:left; width:40px;" ng-click="expandSlotTree(item.id)">{{getSlotExpandButton(item.id)}}</span>
<span ng-click="toggleSlotNameMode()">{{getSlotName(item.id)}}</span>
<span style="width:40px; height:40px; float:right; "><img style="width:40px; margin-top:5px;" ng-click="slotFavoriteToggle(item.id)" ng-attr-src="/ui/modules/apps/beamlrui/{{getSlotFavoriteIcon(item.id)}}" width=30px height=30px></img></span>
</div>

<!-- Slot parts container -->
<div ng-if="expanded[item.id]" ng-init="key = item.id">
<table style="font-size:16px; font-weight:normal; border-collapse: collapse; width: 95%; margin: auto; table-layout: fixed; vertical-align:middle; text-align:center;">

<tr style="width:100px;" ng-if="beamlrData['advinvUsed'][key] != null">
	<td style="width: 100px; height:100px; text-align:left;">
	<img style="display:block;" ng-click="imageClicked(beamlrData['partpreview'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]])" ng-if="beamlrData['partpreview'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]] != null" ng-attr-src="{{beamlrData['partpreview'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]]}}" width=90px height=90px />
	<img style="display:block;" ng-if="beamlrData['partpreview'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]] == null" src="/ui/modules/apps/beamlrui/partimg/none.png" width=90px height=90px />
	</td>
	<td style="width:240px;" ng-if="slotNameMode == 0 && beamlrData['partNames'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]] != null"><strong>{{beamlrData['partNames'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]]}}</strong><br>Odometer {{unitConvertedOdometer(getUsedPartOdometer(beamlrData['advinvUsed'][key])) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}<br>Sell Value ${{getUsedPartSellPrice(beamlrData['advinvUsed'][key]) | number:2}}</td>
	<td style="width:240px;" ng-if="slotNameMode == 1 || beamlrData['partNames'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]] == null">{{beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]}}<br>Odometer {{unitConvertedOdometer(getUsedPartOdometer(beamlrData['advinvUsed'][key])) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}<br>Sell Value ${{getUsedPartSellPrice(beamlrData['advinvUsed'][key]) | number:2}}</td>
	<td style="text-align:right;">
	<button ng-disabled="beamlrData['mainpart']==beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]" style="width:90px;" ng-click="advancedPartSet(key, beamlrData['advinvUsed'][key], '')">Remove</button><br><br>
	<button disabled style="width:90px;">Sell</button>
	</td>
</tr>

<tr ng-repeat="(index,pid) in beamlrData['advinvParts'][key]" style="width:100px;">
	<td style="width: 100px; height:100px; text-align:left;">
	<img style="display:block;" ng-click="imageClicked(beamlrData['partpreview'][beamlrData['advinvData'][pid][0]])" ng-if="beamlrData['partpreview'][beamlrData['advinvData'][pid][0]] != null" ng-attr-src="{{beamlrData['partpreview'][beamlrData['advinvData'][pid][0]]}}" width=90px height=90px />
	<img style="display:block;" ng-if="beamlrData['partpreview'][beamlrData['advinvData'][pid][0]] == null" src="/ui/modules/apps/beamlrui/partimg/none.png" width=90px height=90px />
	</td>
	<td style="width:240px;" ng-if="slotNameMode == 0 && beamlrData['partNames'][beamlrData['advinvData'][pid][0]] != null"><strong>{{beamlrData['partNames'][beamlrData['advinvData'][pid][0]]}}</strong><br>Odometer {{unitConvertedOdometer(beamlrData['advinvData'][pid][1]) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}<br>Sell Value ${{getPartSellPrice(pid) | number:2}}</td>
	<td style="width:240px;" ng-if="slotNameMode == 1 || beamlrData['partNames'][beamlrData['advinvData'][pid][0]] == null">{{beamlrData['advinvData'][pid][0]}}<br>Odometer {{unitConvertedOdometer(beamlrData['advinvData'][pid][1]) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}<br>Sell Value ${{getPartSellPrice(pid) | number:2}}</td>
	<td style="text-align:right;">
	<button style="width:90px;" ng-click="advancedPartSet(key, pid, beamlrData['advinvData'][pid][0])">Use</button><br><br>
	<button ng-if="partSellConfirm[pid] == false || partSellConfirm[pid] == null" ng-click="advancedPartSell(pid)" style="width:90px;">Sell</button>
	<button ng-if="partSellConfirm[pid] == true" ng-click="advancedPartSell(pid)" style="width:90px;">Confirm?</button>
	</td>
</tr>
</table>
</div>


<!-- Recursive tree traversal, using template at the top of this file -->
<div ng-if="item.children.length > 0 && expanded[item.id]" ng-init="items = item.children" ng-include="'part-tree-partial'"></div>

</div>
</div>
</div>

<!-- PART EDIT TREE VIEW MODE END -->

<!-- ORIGINAL BEAMLR EDIT VIEW MODE START -->

<div ng-if="inputData.edittreemode == 0 || searching" ng-repeat="(id,key) in beamlrData['sortedGarageSlots'] track by id">
	<div ng-if="beamlrData['advinvFilter'][key] != null && key != 'main'">
		
		<div style="word-wrap:break-word; text-align:center; font-weight: bold; font-size:20px; width:100%; line-height:40px;">
			<span ng-if="visibleSlots[key] == null || visibleSlots[key] == false" style="float:left; text-align:center; width:40px;" ng-click="slotToggle(key, true)">+</span>
			<span ng-if="visibleSlots[key] == true" style="float:left; text-align:center; width:40px;" ng-click="slotToggle(key, false)">-</span>
			<span style="max-width:80%; display:inline-block; text-align:center;" ng-click="toggleSlotNameMode()"> {{getSlotName(key)}} </span>
			<span style="width:40px; height:40px; float:right; "><img style="width:40px; margin-top:5px;" ng-click="slotFavoriteToggle(key)" ng-attr-src="/ui/modules/apps/beamlrui/{{getSlotFavoriteIcon(key)}}" width=30px height=30px></img></span>
		</div>

		<div ng-if="visibleSlots[key] == true">

			<table style="border-collapse: collapse; width: 95%; margin: auto; table-layout: fixed; vertical-align:middle; text-align:center;">
				<tr style="width:100px;" ng-if="beamlrData['advinvUsed'][key] != null">
					<td style="width: 100px; height:100px; text-align:left;">
					<img style="display:block;" ng-click="imageClicked(beamlrData['partpreview'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]])" ng-if="beamlrData['partpreview'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]] != null" ng-attr-src="{{beamlrData['partpreview'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]]}}" width=90px height=90px />
					<img style="display:block;" ng-if="beamlrData['partpreview'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]] == null" src="/ui/modules/apps/beamlrui/partimg/none.png" width=90px height=90px />
					</td>
					<td style="width:240px;" ng-if="slotNameMode == 0 && beamlrData['partNames'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]] != null"><strong>{{beamlrData['partNames'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]]}}</strong><br>Odometer {{unitConvertedOdometer(getUsedPartOdometer(beamlrData['advinvUsed'][key])) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}<br>Sell Value ${{getUsedPartSellPrice(beamlrData['advinvUsed'][key]) | number:2}}</td>
					<td style="width:240px;" ng-if="slotNameMode == 1 || beamlrData['partNames'][beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]] == null">{{beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]}}<br>Odometer {{unitConvertedOdometer(getUsedPartOdometer(beamlrData['advinvUsed'][key])) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}<br>Sell Value ${{getUsedPartSellPrice(beamlrData['advinvUsed'][key]) | number:2}}</td>
					<td style="text-align:right;">
					<button ng-disabled="beamlrData['mainpart']==beamlrData['advinvData'][beamlrData['advinvUsed'][key]][0]" style="width:90px;" ng-click="advancedPartSet(key, beamlrData['advinvUsed'][key], '')">Remove</button><br><br>
					<button disabled style="width:90px;">Sell</button>
					</td>
				</tr>

				<tr ng-repeat="(index,pid) in beamlrData['advinvParts'][key]" style="width:100px;">
					<td style="width: 100px; height:100px; text-align:left;">
					<img style="display:block;" ng-click="imageClicked(beamlrData['partpreview'][beamlrData['advinvData'][pid][0]])" ng-if="beamlrData['partpreview'][beamlrData['advinvData'][pid][0]] != null" ng-attr-src="{{beamlrData['partpreview'][beamlrData['advinvData'][pid][0]]}}" width=90px height=90px />
					<img style="display:block;" ng-if="beamlrData['partpreview'][beamlrData['advinvData'][pid][0]] == null" src="/ui/modules/apps/beamlrui/partimg/none.png" width=90px height=90px />
					</td>
					<td style="width:240px;" ng-if="slotNameMode == 0 && beamlrData['partNames'][beamlrData['advinvData'][pid][0]] != null"><strong>{{beamlrData['partNames'][beamlrData['advinvData'][pid][0]]}}</strong><br>Odometer {{unitConvertedOdometer(beamlrData['advinvData'][pid][1]) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}<br>Sell Value ${{getPartSellPrice(pid) | number:2}}</td>
					<td style="width:240px;" ng-if="slotNameMode == 1 || beamlrData['partNames'][beamlrData['advinvData'][pid][0]] == null">{{beamlrData['advinvData'][pid][0]}}<br>Odometer {{unitConvertedOdometer(beamlrData['advinvData'][pid][1]) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}<br>Sell Value ${{getPartSellPrice(pid) | number:2}}</td>
					<td style="text-align:right;">
					<button style="width:90px;" ng-click="advancedPartSet(key, pid, beamlrData['advinvData'][pid][0])">Use</button><br><br>
					<button ng-if="partSellConfirm[pid] == false || partSellConfirm[pid] == null" ng-click="advancedPartSell(pid)" style="width:90px;">Sell</button>
					<button ng-if="partSellConfirm[pid] == true" ng-click="advancedPartSell(pid)" style="width:90px;">Confirm?</button>
					</td>
				</tr>
			</table>
			
		</div>
		
	</div>
</div>

<!-- ORIGINAL BEAMLR EDIT VIEW MODE END -->

</div>


<div ng-if="editMode ==1" style="margin-left: 5px; margin-right: 5px; overflow:scroll; overflow-y:scroll; max-height:210px; min-height:210px; max-width:500px; background-color:rgba(0,0,0,0.5);">

<div ng-if="templateFixMode==false">
<table style="width:95%; margin-left:20px; table-layout:fixed; text-align:center;">
<tr ng-repeat="(id, template) in beamlrData['vehicleTemplateList']" style="width:100%; height:50px;">
<td style="text-align:center; width:50%; font-size:20px;">{{template}}</td>
<td style="width:50%;"><button ng-click="loadTemplate(template)">Load</button>&nbsp <button ng-click="saveTemplate(template)">Save As</button>&nbsp <button ng-click="fixTemplateClicked(template)">Fix</button> &nbsp <span style="font-weight:bold; font-size:20px; border-radius:10px; color:red;" ng-click="deleteTemplate(template)">X</span></td>
</tr>
<tr style="width:100%; height:50px;">
<td style="text-align:center; width:50%; font-size:20px;"><input style="width:100%;" type="text" ng-model="inputData.templateName" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()" /></td>
<td style="width:50%; text-align:center;"><button ng-click="saveTemplate(inputData.templateName)">Save</button>&nbsp&nbsp&nbsp<button ng-click="exportConfig(inputData.templateName)">Export</button></td>
</tr>
</table>
</div>

<div ng-if="templateFixMode==true">
<p style="text-align:center; width:100%; font-size:20px; font-weight:bold; margin-top:5px;">Fix Missing Config Parts</p>
<p style="text-align:center; width:100%; font-size:17px;">Parts missing to load this config will be listed below.<br>Select available replacements to fix the config.</p>

<table style="width:95%; margin:auto; table-layout:fixed; text-align:center;">
<tr ng-repeat="(index, part) in templateFixData['missing']" style="width:100%;">
<td style="text-align:center; font-size:20px; font-weight:bold;">
<span style="font-size:24px;">{{beamlrData['partNames'][nameFromPath(part)]}}</span>

<md-checkbox ng-disabled="(templateFixUsedIDs[id] && !templateFixSelected[part][id]) || (!templateFixSelected[part][id] && templateFixSelected[part] != null)" ng-model="templateFixSelected[part][id]" ng-change="onReplacementSelected(part,id)" style="width:90%; text-align:left; margin-left:45px;" ng-repeat="(i, id) in templateFixData['replacements'][part]">
Part #{{id}}
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
{{unitConvertedOdometer(beamlrData['advinvData'][id][1]) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}
</md-checkbox>

</td>


</tr>
</table>

<p ng-if="templateFixNeeded == true" style="width:90%; margin:auto; margin-bottom:10px; margin-top:30px; text-align:center;">
<button style="width:100px;" ng-click="cancelTemplateFix()">Cancel</button>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<button style="width:100px;" ng-click="applyTemplateFix(template)">Apply</button>
<br>
</p>

<p ng-if="templateFixNeeded == false" style="font-weight:bold; width:90%; margin:auto; text-align:center;">
No missing parts found!
</p>

<p ng-if="templateFixNeeded == false" style="width:90%; margin:auto; margin-bottom:10px; margin-top:10px; text-align:center;">
<button style="width:100px;" ng-click="cancelTemplateFix()">Back</button>
</p>

</div>

</div>



<div ng-if="editMode ==2" style="margin-left: 5px; margin-right: 5px; overflow:scroll; overflow-y:scroll; max-height:210px; min-height:210px; max-width:500px; background-color:rgba(0,0,0,0.5);">
<div style="text-align:center; margin:auto; width: 50%; height:50%; ">
<br>
<button ng-click="applyPaint()">Apply Paint</button>
<button ng-click="reloadPaint()">Reload Paint</button>
<br>
</div>
<br>
<div style="text-align:center; margin:auto; width: 50%; height:50%; ">
<ng-color ng-model="beamlrData['paint']['paintA']" presets-editable="false" show-preview="false" paint-number="1"></ng-color>
</div>
<div style="text-align:center; margin:auto; width: 50%; height:50%; ">
<ng-color ng-model="beamlrData['paint']['paintB']" presets-editable="false" show-preview="false" paint-number="2"></ng-color>
</div>
<div style="text-align:center; margin:auto; width: 50%; height:50%; ">
<ng-color ng-model="beamlrData['paint']['paintC']" presets-editable="false" show-preview="false" paint-number="3"></ng-color>
</div>
</div>


</div>

<div ng-if="beamlrData['playerWalking'] != 0">
<h2 style="text-align:center;" > Cannot use while walking. </h2>
</div>

<div ng-if="beamlrData['playerWalking'] == 0">
<div ng-if="beamlrData['triggerState'] != 2">
<h2 style="text-align:center;" > Get to a Garage! </h2>
</div>

<div ng-if="beamlrData['playerDamage'] > 1.0">
<h2 style="text-align:center;" > Vehicle must be fully repaired. </h2>
</div>

<div ng-if="beamlrData['vehicleRestricted'] == true">
<h2 style="text-align:center;" > Cannot edit event restricted vehicle. </h2>
</div>

</div>

</div>

<div ng-if="menuPage==4" style="">

<h3 style="text-align:center; line-height:0px;"> Tuning </h3>

<div ng-if="beamlrData['triggerState'] == 2 && beamlrData['playerDamage'] == 0 && beamlrData['playerWalking'] == 0">
<div style="overflow:scroll; overflow-y:scroll; max-height:220px; max-width:500px; margin-left:5px; margin-right:5px; background-color:rgba(0,0,0,0.5);" >



<div style="margin-bottom:20px;" ng-repeat="(cid, category) in beamlrData['tuningSortedCategories']">

<h3 style="margin:0; text-align:center;">&nbsp{{category}}</h3>

<table style="table-layout:fixed; width:95%; margin:auto;">
<tr style="width:100%;" ng-repeat="(fid, field) in beamlrData['tuningSortedFields'][category]">
<td style="width:40%">{{beamlrData['tuningData'][field]["title"]}}</td>
<td ng-click="preciseTuneDecrease(field, beamlrData['tuningData'][field]['stepDis'])" style="text-align:center; width:20px; font-size:17px; font-weight:bold;">-</td>
<td>
<md-slider flex style="width:90%; margin:auto;" min="{{beamlrData['tuningData'][field]['minDis']}}" max="{{beamlrData['tuningData'][field]['maxDis']}}" step="{{beamlrData['tuningData'][field]['stepDis']}}" ng-change="tuneChanged(field)" ng-model="beamlrData['tuningValues'][field]" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()">
</md-slider>
</td>
<td ng-click="preciseTuneIncrease(field, beamlrData['tuningData'][field]['stepDis'])" style="text-align:center; width:20px; font-size:17px; font-weight:bold;">+</td>
<td style="text-align:right;">{{getTuneData(field)}} &nbsp {{beamlrData['tuningData'][field]['unit']}}</td>
</tr>
</table>

</div>


<!--
<div ng-repeat="(key,value) in beamlrData['tuningData']">
<span style="float:left; transform:translate(5px, 20px)">{{value["title"]}} &nbsp </span>
<span>
<md-slider flex style="width:100px; transform: translate(200px, 10px); " min="{{value['minDis']}}" max="{{value['maxDis']}}" step="{{value['stepDis']}}" ng-change="tuneChanged(key)" ng-model="beamlrData['tuningValues'][key]" ng-focus="textboxClick()" ng-mouseup="textboxHover()" ng-mouseenter="textboxHover()">
</md-slider>
</span>
<span style="float:right; transform:translate(-5px, -25px)">{{getTuneData(key)}} &nbsp {{value['unit']}}</span>
</div>
-->

</div>

<div>

<p style="width:100%; text-align:center; margin-bottom:20px;">
<button style="margin-right:100px;" ng-click="resetTune()"> Reset </button>
<button style="margin-left:100px;" ng-click="applyTune()"> Apply </button>
</p>


</div>


</div>

<div ng-if="beamlrData['playerWalking'] != 0">
<h2 style="text-align:center;" > Cannot use while walking. </h2>
</div>

<div ng-if="beamlrData['playerWalking'] == 0">
<div ng-if="beamlrData['triggerState'] != 2">
<h2 style="text-align:center;" > Get to a Garage! </h2>
</div>

<div ng-if="beamlrData['playerDamage'] != 0">
<h2 style="text-align:center;" > Vehicle must be fully repaired. </h2>
</div>
</div>

</div>


<div ng-if="menuPage == 5" style="">

<h3 style="text-align:center; line-height:0px;">Track Events</h3>

<div ng-if="beamlrData['currentTrackEvent']['status'] != null && beamlrData['currentTrackEvent']['status'] != 'over'">

<h2 style="text-align:center; margin-top:0px; margin-bottom:0px;">Current Event Info</h2>

<div style="overflow:scroll; overflow-y:scroll; height: 190px; max-height:190px; max-width:500px; margin-left:5px; margin-right:5px; background-color:rgba(0,0,0,0.5);" >
<table style="width:100%; table-layout:fixed; vertical-align:top;">
<tr style="height:35px;"><td style="width: 150px; font-size:18px; font-weight:bold; text-align:center;">Title </td><td style="text-align:center;">{{beamlrData['currentTrackEvent']['title']}}</td></tr>
<tr style="height:35px;"><td style="width: 150px;font-size:18px; font-weight:bold; text-align:center;">Map </td><td style="text-align:center;">{{beamlrData['currentTrackEvent']['map']}}</td></tr>
<tr style="height:35px;"><td style="width: 150px;font-size:18px; font-weight:bold; text-align:center;">Status</td><td style="text-align:center;">{{beamlrData['currentTrackEvent']['status']}}</td></tr>
<tr style="height:35px;"><td style="width: 150px;font-size:18px; font-weight:bold; text-align:center;">Round</td><td style="text-align:center;">{{beamlrData['currentTrackEvent']['cround']}} / {{beamlrData['currentTrackEvent']['tround']}}</td></tr>
<tr style="height:35px;"><td style="width: 150px;font-size:18px; font-weight:bold; text-align:center;">Car Used</td><td style="text-align:center;">{{beamlrData['currentTrackEvent']['carname']}}</td></tr>
</table>
</div>

<p style="margin-left:5px; margin-right:5px; text-align:center; transform:translate(0px, -12px);">
<span style="float:left;"><button ng-click="showEventBrowser()">Browse Events</button></span>
<button ng-click="showPastEvents()">Event History</button>
<span style="float:right;"><button ng-click="abandonEvent()" ng-if="beamlrData['currentTrackEvent']['status'] != 'over'">Abandon Event</button></span></p>

</div>

<div ng-if="beamlrData['currentTrackEvent']['status'] == 'over' || beamlrData['currentTrackEvent']['status'] == null">

<h2 style="text-align:center;">No event in progress</h2>

<p style="text-align:center; transform:translate(0px, -10px);">
<button ng-click="showEventBrowser()">Browse Events</button>
<button ng-click="showPastEvents()">Event History</button>
</p>

</div>

</div>

<div ng-if="menuPage == 6" style="">

<h3 style="text-align:center; line-height:0px;">
<span ng-click="setInventoryMode(0)" ng-if="invmode == 0" style="color:#FF6600;">Item Inventory</span>
<span ng-click="setInventoryMode(0)" ng-if="invmode == 1" style="color:white;">Item Inventory</span>
&nbsp&nbsp&nbsp&nbsp&nbsp
<span ng-click="setInventoryMode(1)" ng-if="invmode == 1" style="color:#FF6600;">Part Inventory</span>
<span ng-click="setInventoryMode(1)" ng-if="invmode == 0" style="color:white;">Part Inventory</span>
</h3>

<div style="overflow:scroll; height:250px; max-height:250px; width:95%; margin:auto; background-color:rgba(0,0,0,0.5);">

<div ng-if="invmode == 0">
<h3 ng-if="sortedItemInventoryKeys.length <= 0" style="text-align:center; width: 90%; margin:auto; margin-top:10px; font-size:14px;">Tip: You can buy items like oil bottles & fuel cans by getting out of your car at a gas station!</h3>
<table style="width:100%; table-layout:fixed; text-align:center; border-spacing:3px;">
<tr style="width:100%; height:10px;">
<td style="width:25%; font-weight:bold; font-size:20px;"></td>
<td style="width:60%; font-weight:bold; font-size:20px;"></td>
<td style="width:10%; font-weight:bold; font-size:17px;"></td>
<td style="width:10%; font-weight:bold; font-size:17px;"></td>
</tr>
<tr style="width:100%; height:100px;" ng-repeat="(k,v) in sortedItemInventoryKeys">
<td style="width:20%; font-size:17px;">
<img ng-attr-src="{{beamlrData['itemInventory'][v].image}}" width=70 height=70></img>
</td>
<td style="width:70%; font-size:17px;"><span style="font-weight:bold;">{{beamlrData['itemInventory'][v].iname}}</span><br>{{beamlrData['itemInventory'][v].idata}}</td>
<td style="width:10%; font-size:17px;"><button ng-click="inventoryUse(v)">Use</button></td>
<td style="width:10%; font-size:17px;"><button ng-click="inventoryDiscard(v)">X</button></td>
</tr>
</table>
</div>

<div ng-if="invmode == 1">
<h3 style="text-align:center; width: 90%; font-size:14px; margin:auto; margin-top:10px;">
This menu shows all unused parts in your inventory so you can sell them.
</h3>

<div ng-repeat="(index,slot) in beamlrData['fidSortedSlots']">

<div style="word-wrap:break-word; text-align:center; font-weight: bold; font-size:20px; width:100%; line-height:40px;">
<span ng-click="slotToggle(slot, true)" ng-if="visibleSlots[slot] == null || visibleSlots[slot] == false" style="float:left; width:40px; text-align:center;">+</span>
<span ng-click="slotToggle(slot, false)" ng-if="visibleSlots[slot] == true" style="float:left; width:40px; text-align:center;">-</span>
<span ng-click="setSlotNameMode(1)" ng-if="slotNameMode == 0 && beamlrData['fidSlotNames'][slot] != null" style="display:inline-block; max-width:80%; text-align:center;">{{beamlrData['fidSlotNames'][slot]}}</span>
<span ng-click="setSlotNameMode(0)" ng-if="slotNameMode == 1 || beamlrData['fidSlotNames'][slot] == null" style="display:inline-block; max-width:80%; text-align:center;">{{slot}}</span>
<span ng-click="slotToggle(slot, true)" ng-if="visibleSlots[slot] == null || visibleSlots[slot] == false" style="float:right; width:40px; text-align:center;">+</span>
<span ng-click="slotToggle(slot, false)" ng-if="visibleSlots[slot] == true" style="float:right; width:40px; text-align:center;">-</span>

</div>

<div ng-if="visibleSlots[slot] == true">
<table style="border-collapse: collapse; width: 95%; margin: auto; table-layout: fixed; vertical-align:middle; text-align:center;">

<tr ng-repeat="(key,pid) in beamlrData['fidInventory'][slot]" style="width:100px;">
	<td style="width: 100px; height:100px; text-align:left;">
	<img style="display:block;" ng-click="imageClicked(beamlrData['partpreview'][beamlrData['advinvData'][pid][0]])" ng-if="beamlrData['partpreview'][beamlrData['advinvData'][pid][0]] != null" ng-attr-src="{{beamlrData['partpreview'][beamlrData['advinvData'][pid][0]]}}" width=90px height=90px />
	<img style="display:block;" ng-if="beamlrData['partpreview'][beamlrData['advinvData'][pid][0]] == null" src="/ui/modules/apps/beamlrui/partimg/none.png" width=90px height=90px />
	</td>
	<td style="width:240px;" ng-if="slotNameMode == 0 && beamlrData['fidPartNames'][beamlrData['advinvData'][pid][0]] != null"><strong>{{beamlrData['fidPartNames'][beamlrData['advinvData'][pid][0]]}}</strong><br>Odometer {{unitConvertedOdometer(beamlrData['advinvData'][pid][1]) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}<br>Sell Value ${{getPartSellPrice(pid) | number:2}}</td>
	<td style="width:240px;" ng-if="slotNameMode == 1 || beamlrData['fidPartNames'][beamlrData['advinvData'][pid][0]] == null">{{beamlrData['advinvData'][pid][0]}}<br>Odometer {{unitConvertedOdometer(beamlrData['advinvData'][pid][1]) / 1000.0 | number:1}} {{beamlrData['advinvUnits'] == 'imperial' ? 'mi': 'km'}}<br>Sell Value ${{getPartSellPrice(pid) | number:2}}</td>
	<td style="text-align:right;">
	<button ng-if="partSellConfirm[pid] == false || partSellConfirm[pid] == null" ng-click="advancedPartSell(pid)" style="width:90px;">Sell</button>
	<button ng-if="partSellConfirm[pid] == true" ng-click="advancedPartSell(pid)" style="width:90px;">Confirm?</button>
	</td>
</tr>
</table>
</div>








</div>


</div>
</div>





<div ng-if="!showMenu" style="z-index: 9; position:relative;">


</div>
</div>
</div>